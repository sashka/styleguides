Оформление кода на C++
======================

Отступы
-------
1. Для отступов в коде нужно использовать пробелы, а не табуляцию. Табуляцию нужно использовать только тогда, когда без неё нельзя обойтись (например, в Makefile).

2. Размер остступа равен 2-м или 4-м пробелам.

3. В пределах одного файла используется только один размер отступа. Если автор файла использовал отступ в 4 пробела, то при редактировании нужно использовать такой же отступ.

4. Код внутри пространства имён (namespace), классов и т.п. нужно выделять отступами.

   _Правильно:_
    
        namespace mediaplanner {
     
            class Config {
                Config();
                ...
            }; 
        
        } // namespace mediaplanner


   _Неправильно:_
      
        namespace mediaplanner {
     
        class Config {
            Config();
            ...
        }; 
    
        } // namespace mediaplanner

5. Ключевые слова _public_, _protected_, _private_ в классах должны находиться на одном уровне с объявлением класса. Порядок следования: _public_, _protected_ и _private_.

    _Правильно:_
        class Accessor {
        public:
          ...
  
        protected:
          ...
  
        private:
          ...
        };

    
    _Неправильно:_
  
        class Accessor {
          protected:
            ...
    
          public:
            ...
    
          private:
            ...
        };

Пробелы
-------
1. Не нужно использовать пробел с унарными операторами.

    _Правильно:_
        ++i;
        i++;

    _Неправильно:_
        i ++;
        ++ i;

2. Нужно ставить пробелы вокруг бинарных, тернарных операторов и после запятой.

    _Правильно:_
        y = m * x + b;
        c =  a | b;
        f(x, y);
        return condition ? 1 : 0;

    _Неправильно:_
        y = m*x+b;
        c =  a|b;
        f(x,y);
        return condition ? 1:0;

3. Между ключевым словом и открывающей скобкой нужно ставить пробел.

    _Правильно:_
        if (condition) {
            Action();
        }

    _Неправильно:_
        if(condition) {
            Action();
        }

4. Не нужно ставить пробел между именем функции и открывающей скобкой. Тем более, не нужен пробел после открывающей скобки и перед закрывающей.

    _Правильно:_
        f(a, b);

    _Неправильно:_
        f (a, b);
        f( a, b );

5. Если тип является указателем или ссылкой, то между именем базового типа и знаком "*" или "&" пробел не ставится.

    _Правильно:_
        Document* LoadDocument(const FilePath& path);

    _Неправильно:_
        Document *LoadDocument(const FilePath &path);
        Document * LoadDocument(const FilePath & path);


Перенос строк
-------------
1. Каждое выражение должно быть записано на отдельной строке.

    _Правильно_:
        ++x;
        y++;
        if (condition) {
            Action();
        }

    _Неправильно:_
        ++x; y++;
        if (condition) { Action(); }


Фигурные скобки
---------------
1. Открывающая фигурная скобка всегда ставится в конце строки, перед блоком кода. Закрывающая скобка ставится на новой строке.

    _Правильно:_
        class Storage {
            Storage(string& filename);
            ...
        };
  
        namespace threads {
            ...
        };  
   
        for (int i = 0; i < 10; ++i) {
            Action();
        }

    _Неправильно:_
        class Storage 
        {
            Storage(string& filename);
            ...
        };
  
        for (int i = 0; i < 10; ++i) 
        {
            Action();
        }


2. Фигурные скобки ставятся всегда, даже если внутри них нет кода.

    _Правильно:_
        for (int i = container->begin(); i != container->end(); ++i) {
        }

    _Неправильно:_
        for (int i = container->begin(); i != container->end(); ++i);


Использование NULL, false и 0
-----------------------------
1. В C++ нулевой указатель нужно записывать как 0, в C — как NULL. 

2. В C++ и C значения типа bool нужно записывать как _true_ и _false_. Поддержка типа bool для C включена в _base/basictypes.h_.

3. Проверка указателей на равенство нулевому должны быть записаны в явном виде.

    _Правильно:_
        Vector* ptr = new Vector();
        if (ptr == 0) {
            Abort("Everything goes bad");
            ...
        };

    _Неправильно:_
        if (!ptr) {
            ...
        };

4. Проверка логического значения записывается без сравнения.

    _Правильно:_
        bool condition = true;
        if (condition) {
            ...
        };

    _Неправильно:_
        if (condition == true) {
            ...
        };

5. Проверка равенства чисел нулю должна быть записано явно.

    _Правильно:_
        int n;
        if (n == 0) {
            ...
        };
  
        if (n != 0) {
            ...
        };


    _Неправильно:_
        if (n) {
            ...
        };
  
        if (!n) {
            ...
        };

Макросы
-------
1. Не нужно использовать макросы, всегда и везде, где их можно не использовать.

2. Для объявления констант нужно использовать _const_ вместо #define.

3. Лучше использовать inline-функцию вместо макроса.

4. Имя макроса должно быть записано _заглавными_ буквами, чтобы визуально отличаться от методов и переменных. Если имя макроса состоит из нескольких слов, они должны быть разделены символами подчёркивания "_".

    _Правильно:_
        #define DEFINE_PROPERTY(key, val) wxConvCurrent->cWX2MB(key, val)
      
    _Неправильно:_
        #define define_property(key, val) wxConvCurrent->cWX2MB(key, val)
        #define DefineProperty(key, val) wxConvCurrent->cWX2MB(key, val);

Перечисления
------------
1. Значения перечислений нужно писать заглавными буквами.

2. Значения должны иметь приставку с названием перечисления.

    _Правильно:_
        enum RCodes {
          RCODE_UNKNOWN,
          RCODE_SUCCESS
        };
  

    _Неправильно:_
        enum RCodes {
          Unknown,
          Success
        };

Параметры методов по-умолчанию
------------------------------
1. Параметры по-умолчанию задаются только в заголовочном файле, в объявлении методов.

    _Правильно:_
        class A {
        public:
          void Hello(const std::string& message = "Hi!");
        };

    _Неправильно:_
        void A::Hello(const std::string& message = "Hi!") {
          ...
        }

2. Параметры по-умолчанию нельзя задавать у виртуальных методов, иначе есть риск наткнуться на то, что они наследуются из родительского класса.

    _Пример:_
        class A {
        public:
            virtual void bla(int x = 1);
        };
  
        class B : public A {
        public:
            void bla(int x = 2);
        };
  
        A a = B();
        a.bla(); // принимает x = 1



Полезное чтение
===============
[Google C++ Style Guide][google-styleguide]


[google-styleguide]:http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml