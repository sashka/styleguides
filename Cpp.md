Оформление кода на C++
======================

Форматирование кода
-------------------
1. Код всегда сохраняется в кодировке UTF-8.

2. Для отступов в коде нужно использовать пробелы, а не табуляцию. Табуляцию можно использовать только тогда, когда без неё нельзя обойтись (например, в Makefile).

3. Размер остступа равен 2-м или 4-м пробелам. В пределах одного файла используется только один размер отступа. Если автор файла использовал отступ в 4 пробела, то при редактировании нужно использовать такой же отступ.

4. Код внутри `namespace` не выделяется отступами. Завершение пространства имён должно быть отмечено комментарием с указанием завершаемого namespace.

   _Правильно:_

        namespace mediaplanner {
           
            class Config {
               Config();
               ...
            }; 
            
        } // namespace mediaplanner


   _Неправильно:_

        namespace mediaplanner {
         
            class Config {
                Config();
                ...
            }; 
          
        } // namespace mediaplanner

5. Код внутри `class`, `enum`, `struct` и т.п. нужно выделять отступами.

   _Правильно:_
    
		class SimpleConfig {
			SimpleConfig();
			...
		};


   _Неправильно:_
      
        class Config {
        Config();
        ...
        }; 

6. Ключевые слова `public`, `protected`, `private` в классах должны находиться на одном уровне с объявлением класса. Порядок следования: `public`, `protected` и `private`.

    _Правильно:_

        class Accessor {
        public:
          ...
  
        protected:
          ...
  
        private:
          ...
        };

    
    _Неправильно:_
  
        class Accessor {
          protected:
            ...
    
          public:
            ...
    
          private:
            ...
        };


Пробелы
-------
1. Не нужно использовать пробел с унарными операторами.

    _Правильно:_

        ++i;
        i++;


    _Неправильно:_

        i ++;
        ++ i;


2. Нужно ставить пробелы вокруг бинарных, тернарных операторов и после запятой.

    _Правильно:_

        y = m * x + b;
        c =  a | b;
        f(x, y);
        return condition ? 1 : 0;


    _Неправильно:_

        y = m*x+b;
        c =  a|b;
        f(x,y);
        return condition ? 1:0;


3. Между ключевым словом и открывающей скобкой нужно ставить пробел.

    _Правильно:_

        if (condition) {
            Action();
        }


    _Неправильно:_

        if(condition) {
            Action();
        }


4. Не нужно ставить пробел между именем функции и открывающей скобкой. Тем более, не нужен пробел после открывающей скобки и перед закрывающей.

    _Правильно:_

        f(a, b);

    _Неправильно:_

        f (a, b);
        f( a, b );


5. Если тип является указателем или ссылкой, то между именем базового типа и знаком "*" или "&" пробел не ставится.

    _Правильно:_

        Document* LoadDocument(const FilePath& path);


    _Неправильно:_

        Document *LoadDocument(const FilePath &path);
        Document * LoadDocument(const FilePath & path);


Перенос строк
-------------
1. Каждое выражение должно быть записано на отдельной строке.

    _Правильно:_

        ++x;
        y++;
        if (condition) {
            Action();
        }


    _Неправильно:_

        ++x; y++;
        if (condition) { Action(); }


Фигурные скобки
---------------
1. Открывающая фигурная скобка всегда ставится в конце строки, перед блоком кода. Закрывающая скобка ставится на новой строке.

    _Правильно:_

        class Storage {
            Storage(string& filename);
            ...
        };
  
        namespace threads {
            ...
        };  
   
        for (int i = 0; i < 10; ++i) {
            Action();
        }


    _Неправильно:_

        class Storage 
        {
            Storage(string& filename);
            ...
        };
  
        for (int i = 0; i < 10; ++i) 
        {
            Action();
        }


2. Фигурные скобки ставятся всегда, даже если внутри них нет кода.

    _Правильно:_

        for (int i = container->begin(); i != container->end(); ++i) {
        }


    _Неправильно:_

        for (int i = container->begin(); i != container->end(); ++i);


Использование NULL, false и 0
-----------------------------
1. В C и C++ нулевой указатель нужно записывать как `NULL`, целочисленное значение как `0`, значение с плавающей точкой как `0.0`, символ как `'\0'`. 

2. В C++ и C значения типа bool нужно записывать как `true` и `false`. Поддержка типа bool для C включена в `base/basictypes.h`.

3. Проверка указателей на равенство нулевому должны быть записаны в явном виде.

    _Правильно:_

        Vector* ptr = new Vector();
        if (ptr == NULL) {
            Abort("Everything goes bad");
            ...
        };


    _Неправильно:_

        if (!ptr) {
            ...
        };

4. Проверка логического значения записывается без сравнения.

    _Правильно:_

        bool condition = true;
        if (condition) {
            ...
        };

    _Неправильно:_

        if (condition == true) {
            ...
        };

5. Проверка равенства чисел нулю должна быть записано явно.

    _Правильно:_

        int n;
        if (n == 0) {
            ...
        };

		float f;  
        if (f != 0.0) {
            ...
        };


    _Неправильно:_

        if (n) {
            ...
        };
  
        if (!f) {
            ...
        };


Макросы
-------
1. Не нужно использовать макросы, всегда и везде, где их можно не использовать.

2. Для объявления констант нужно использовать `const` вместо `#define`.

3. Лучше использовать inline-функцию вместо макроса.

4. Имя макроса должно быть записано _заглавными_ буквами, чтобы визуально отличаться от методов и переменных. Если имя макроса состоит из нескольких слов, они должны быть разделены символами подчёркивания "_".

    _Правильно:_

        #define DEFINE_PROPERTY(key, val) wxConvCurrent->cWX2MB(key, val)
      
    _Неправильно:_

        #define define_property(key, val) wxConvCurrent->cWX2MB(key, val)
        #define DefineProperty(key, val) wxConvCurrent->cWX2MB(key, val);


Константы и перечисления
------------------------
1. Имена констант записываются как `kDaysInWeek`. Артикли и прочие незначащие конструкции английского языка следует опускать.

2. Значения перечислений должны подчиняться либо правилу именования констант (`kError404NotFound`), либо правило именования макросов (`ERROR_404_NOT_FOUND`).


Параметры методов по-умолчанию
------------------------------
1. Параметры по-умолчанию задаются только в заголовочном файле, в объявлении методов.

    _Правильно:_

        class A {
        public:
          void Hello(const std::string& message="Hi!");
        };

    _Неправильно:_

        void A::Hello(const std::string& message = "Hi!") {
          ...
        }

2. Параметры по-умолчанию нельзя задавать у виртуальных методов класса. Есть риск наткнуться на то, что они наследуются из родительского класса.

    _Пример:_

        class A {
        public:
            virtual void bla(int x = 1);
        };
  
        class B : public A {
        public:
            void bla(int x = 2);
        };
  
        A a = B();
        a.bla(); // принимает x = 1



Полезное чтение
===============
[Google C++ Style Guide](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml)
